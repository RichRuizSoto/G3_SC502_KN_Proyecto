<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login / Registro</title>
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="stylesheet" href="/static/css/login.css" />
  </head>
  <body>
    <script src="/static/js/header.js"></script>

    <main class="auth-container">
      <div class="auth-box">
        <div class="tabs">
          <button class="tab-btn active" data-tab="login">Iniciar Sesión</button>
          <button class="tab-btn" data-tab="register">Registrarse</button>
        </div>

        <form id="login" class="auth-form active">
          <h2>Inicia Sesión</h2>
          <input type="email" placeholder="Correo electrónico" required />
          <input type="password" placeholder="Contraseña" required />
          <button type="submit">Entrar</button>
          <p class="forgot">¿Olvidaste tu contraseña?</p>
        </form>

        <form id="register" class="auth-form">
          <h2>Regístrate</h2>

          <input id="reg_nombre" type="text" placeholder="Nombre completo" required />
          <input id="reg_correo" type="email" placeholder="Correo electrónico" required />
          <input id="reg_pass" type="password" placeholder="Contraseña" required />
          <input id="reg_pass2" type="password" placeholder="Confirmar contraseña" required />

          <button type="submit">Crear cuenta</button>
        </form>
      </div>
    </main>

    <script src="/static/js/footer.js"></script>

    <script>
      const tabs = document.querySelectorAll(".tab-btn");
      const forms = document.querySelectorAll(".auth-form");

      tabs.forEach((tab) => {
        tab.addEventListener("click", () => {
          tabs.forEach((t) => t.classList.remove("active"));
          forms.forEach((f) => f.classList.remove("active"));
          tab.classList.add("active");
          document.getElementById(tab.dataset.tab).classList.add("active");
        });
      });
    </script>
<script>
  document.getElementById("register").addEventListener("submit", async function (e) {
    e.preventDefault();

    const nombre = this.querySelector("input[placeholder='Nombre completo']").value;
    const correo = this.querySelector("input[placeholder='Correo electrónico']").value;
    const contrasena = this.querySelector("input[placeholder='Contraseña']").value;
    const confirmar = this.querySelector("input[placeholder='Confirmar contraseña']").value;

    if (contrasena !== confirmar) {
      alert("Las contraseñas no coinciden");
      return;
    }

    const data = {
      nombre: nombre,
      correo: correo,
      contrasena: contrasena
    };

    try {
      const response = await fetch("/api/register", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(data),
      });

      const result = await response.json();

      if (response.ok) {
        alert("Cuenta creada con éxito");
        window.location.href = "/login"; // o donde quieras redirigir
      } else {
        alert("Error: " + result.error);
      }
    } catch (error) {
      alert("Error de conexión con el servidor");
      console.error(error);
    }
  });
</script>


  </body>
</html>
